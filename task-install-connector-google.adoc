---
sidebar: sidebar 
permalink: task-install-connector-google.html 
keywords: install connector, google cloud connector installation, google cloud connector, install connector in google cloud, bluexp, gcloud, manual install, create connector, gcp installation, gcp connector 
summary: 'Créez un connecteur directement à partir de la console web BlueXP, à l"aide de gcloud ou en installant le logiciel sur votre propre hôte Linux.' 
---
= Créez un connecteur dans Google Cloud
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Créez un connecteur directement à partir de la console web BlueXP, à l'aide de gcloud ou en installant le logiciel sur votre propre hôte Linux.

[role="tabbed-block"]
====
.BlueXP
--
.Ce dont vous avez besoin
* Les autorisations Google Cloud requises pour créer le connecteur et un compte de service pour la VM Connector.
+
link:task-set-up-permissions-google.html["Découvrez comment configurer des autorisations Google Cloud"]

* VPC et sous-réseau qui répondent aux exigences réseau.
+
link:task-set-up-networking-google.html["En savoir plus sur les exigences de mise en réseau"]

* Détails sur un serveur proxy, si un proxy est requis pour accéder à Internet à partir du connecteur.


.Étapes
. Cliquez sur le menu déroulant *Connector* et sélectionnez *Ajouter un connecteur*.
+
image:screenshot_connector_add.gif["Capture d'écran affichant l'icône du connecteur dans l'en-tête et l'action Ajouter un connecteur."]

. Choisissez *Google Cloud Platform* comme fournisseur de cloud.
. Sur la page *déploiement d'un connecteur*, consultez les détails de ce dont vous aurez besoin. Vous avez deux options :
+
.. Cliquez sur *Continuer* pour préparer le déploiement à l'aide du guide d'utilisation du produit. Chaque étape du guide du produit inclut les informations contenues sur cette page de la documentation.
.. Cliquez sur *passer au déploiement* si vous avez déjà préparé en suivant les étapes de cette page.


. Suivez les étapes de l'assistant pour créer le connecteur :
+
** Si vous y êtes invité, connectez-vous à votre compte Google, qui devrait disposer des autorisations requises pour créer l'instance de machine virtuelle.
+
Le formulaire est détenu et hébergé par Google. Vos identifiants ne sont pas fournis à NetApp.

** *Détails* : saisissez un nom pour l'instance de machine virtuelle, spécifiez des balises, sélectionnez un projet, puis sélectionnez le compte de service qui dispose des autorisations requises (reportez-vous à la section ci-dessus pour plus de détails).
** *Location* : spécifiez une région, une zone, un VPC et un sous-réseau pour l'instance.
** *Réseau* : permet d'activer ou non une adresse IP publique et de spécifier éventuellement une configuration proxy.
** *Stratégie de pare-feu* : choisissez de créer une nouvelle politique de pare-feu ou de sélectionner une politique de pare-feu existante qui autorise les règles entrantes et sortantes requises.
+
link:reference-ports-gcp.html["Règles de pare-feu dans Google Cloud"]

** *Review* : consultez vos sélections pour vérifier que votre configuration est correcte.


. Cliquez sur *Ajouter*.
+
L'instance doit être prête dans environ 7 minutes. Vous devez rester sur la page jusqu'à ce que le processus soit terminé.



.Résultat
Une fois le processus terminé, le connecteur est disponible pour être utilisé depuis BlueXP.

--
.gcloud
--
.Ce dont vous avez besoin
* Les autorisations Google Cloud requises pour créer le connecteur et un compte de service pour la VM Connector.
+
link:task-set-up-permissions-google.html["Découvrez comment configurer des autorisations Google Cloud"]

* VPC et sous-réseau qui répondent aux exigences réseau.
+
link:task-set-up-networking-google.html["En savoir plus sur les exigences de mise en réseau"]



.Étapes
. Connectez-vous au SDK gcloud à l'aide de la méthodologie que vous préférez.
+
Dans nos exemples, nous allons utiliser un shell local avec le SDK gcloud installé, mais vous pouvez utiliser le Google Cloud Shell natif dans la console Google Cloud.

+
Pour plus d'informations sur le kit de développement logiciel Google Cloud, rendez-vous sur le link:https://cloud.google.com/sdk["Page de documentation du SDK Google Cloud"^].

. Vérifiez que vous êtes connecté en tant qu'utilisateur disposant des autorisations requises définies dans la section ci-dessus :
+
[source, bash]
----
gcloud auth list
----
+
Le résultat doit indiquer les éléments suivants où le compte d'utilisateur * est le compte d'utilisateur souhaité pour être connecté en tant que :

+
[listing]
----
Credentialed Accounts
ACTIVE  ACCOUNT
     some_user_account@domain.com
*    desired_user_account@domain.com
To set the active account, run:
 $ gcloud config set account `ACCOUNT`
Updates are available for some Cloud SDK components. To install them,
please run:
$ gcloud components update
----
. Exécutez le `gcloud compute instances create` commande :
+
[source, bash]
----
gcloud compute instances create <instance-name>
  --machine-type=n2-standard-4
  --image-project=netapp-cloudmanager
  --image-family=cloudmanager
  --scopes=cloud-platform
  --project=<project>
  --service-account=<service-account>
  --zone=<zone>
  --no-address
  --tags <network-tag>
  --network <network-path>
  --subnet <subnet-path>
  --boot-disk-kms-key <kms-key-path>
----
+
nom de l'instance:: Nom d'instance souhaité pour l'instance de VM.
projet:: (Facultatif) le projet où vous souhaitez déployer la machine virtuelle.
compte de service:: Compte de service spécifié dans la sortie de l'étape 2.
zone:: La zone où vous souhaitez déployer la machine virtuelle
pas d'adresse:: (Facultatif) aucune adresse IP externe n'est utilisée (vous avez besoin d'un NAT ou d'un proxy cloud pour acheminer le trafic vers l'Internet public)
balise réseau:: (Facultatif) Ajouter un marquage réseau pour lier une règle de pare-feu à l'aide de balises à l'instance de connecteur
chemin du réseau:: (Facultatif) Ajoutez le nom du réseau dans lequel déployer le connecteur (pour un VPC partagé, vous avez besoin du chemin complet)
chemin-sous-réseau:: (Facultatif) Ajouter le nom du sous-réseau dans lequel déployer le connecteur (pour un VPC partagé, vous devez disposer du chemin complet)
km-key-path:: (Facultatif) Ajouter une clé KMS pour chiffrer les disques du connecteur (les autorisations IAM doivent également être appliquées)
+
--
Pour plus d'informations sur ces indicateurs, visitez le link:https://cloud.google.com/sdk/gcloud/reference/compute/instances/create["Documentation du kit de développement logiciel de calcul Google Cloud"^].

--


+
L'exécution de la commande déploie le connecteur à l'aide de l'image de référence NetApp. L'instance de connecteur et le logiciel doivent s'exécuter dans environ cinq minutes.

. Ouvrez un navigateur Web à partir d'un hôte connecté à l'instance Connector et saisissez l'URL suivante :
+
https://_ipaddress_[]

. Une fois connecté, configurez le connecteur :
+
.. Spécifiez le compte BlueXP à associer au connecteur.
+
link:concept-netapp-accounts.html["Découvrez les comptes BlueXP"].

.. Entrez un nom pour le système.




.Résultat
Le connecteur est maintenant installé et configuré avec votre compte BlueXP.

Ouvrez un navigateur Web et accédez au https://console.bluexp.netapp.com["Console BlueXP"^] Pour commencer à utiliser le connecteur avec BlueXP.

--
.Installation manuelle
--
.Ce dont vous avez besoin
* Privilèges root pour installer le connecteur.
* Détails sur un serveur proxy, si un proxy est requis pour accéder à Internet à partir du connecteur.
+
Vous avez la possibilité de configurer un serveur proxy après l'installation, mais cela nécessite de redémarrer le connecteur.

* Un certificat signé par une autorité de certification, si le serveur proxy utilise HTTPS ou si le proxy est un proxy interceptant.


.Description de la tâche
* L'installation installe les outils de ligne de commande AWS (awscli), afin d'activer les procédures de reprise à partir du support NetApp.
+
Si vous recevez un message indiquant que l'installation de awscli a échoué, vous pouvez ignorer le message en toute sécurité. Le connecteur peut fonctionner sans outils.

* Le programme d'installation disponible sur le site du support NetApp peut être une version antérieure. Après l'installation, le connecteur se met automatiquement à jour si une nouvelle version est disponible.


.Étapes
. Vérifiez que docker est activé et exécuté.
+
[source, cli]
----
sudo systemctl enable docker && sudo systemctl start docker
----
. Si les variables système _http_proxy_ ou _https_proxy_ sont définies sur l'hôte, supprimez-les :
+
[source, cli]
----
unset http_proxy
unset https_proxy
----
+
Si vous ne supprimez pas ces variables système, l'installation échouera.

. Téléchargez le logiciel du connecteur à partir du https://mysupport.netapp.com/site/products/all/details/cloud-manager/downloads-tab["Site de support NetApp"^], Puis copiez-le sur l'hôte Linux.
+
Vous devez télécharger le programme d'installation du connecteur « en ligne » destiné à être utilisé sur votre réseau ou dans le cloud. Un programme d'installation séparé « hors ligne » est disponible pour le connecteur, mais il n'est pris en charge que pour les déploiements en mode privé.

. Attribuez des autorisations pour exécuter le script.
+
[source, cli]
----
chmod +x OnCommandCloudManager-<version>
----
+
Où <version> est la version du connecteur que vous avez téléchargé.

. Exécutez le script d'installation.
+
[source, cli]
----
 ./OnCommandCloudManager-<version> --proxy <HTTP or HTTPS proxy server> --cacert <path and file name of a CA-signed certificate>
----
+
Les paramètres --proxy et --cacert sont facultatifs. Si vous disposez d'un serveur proxy, vous devez entrer le ou les paramètres comme indiqué. Le programme d'installation ne vous invite pas à fournir des informations sur un proxy.

+
Voici un exemple de commande utilisant les deux paramètres facultatifs :

+
[source, cli]
----
 ./OnCommandCloudManager-V3.9.26 --proxy https://user:password@10.0.0.30:8080/ --cacert /tmp/cacert/certificate.cer
----
+
--proxy configure le connecteur pour utiliser un serveur proxy HTTP ou HTTPS à l'aide de l'un des formats suivants :

+
** \http://address:port
** \http://username:password@address:port
** \https://address:port
** \https://username:password@address:port
+
L'utilisateur doit être un utilisateur local. Les utilisateurs du domaine ne sont pas pris en charge.



+
--cacert spécifie un certificat signé par une autorité de certification à utiliser pour l'accès HTTPS entre le connecteur et le serveur proxy. Ce paramètre est requis uniquement si vous spécifiez un serveur proxy HTTPS ou si le proxy est un proxy interceptant.

. Attendez la fin de l'installation.
+
À la fin de l'installation, le service connecteur (ocm) redémarre deux fois si vous avez spécifié un serveur proxy.

. Ouvrez un navigateur Web à partir d'un hôte connecté à la machine virtuelle Connector et entrez l'URL suivante :
+
https://_ipaddress_[]

. Une fois connecté, configurez le connecteur :
+
.. Spécifiez le compte BlueXP à associer au connecteur.
.. Entrez un nom pour le système.
.. Sous *exécutez-vous dans un environnement sécurisé ?* maintenez le mode restreint désactivé.
+
Vous devez désactiver le mode restreint, car ces étapes décrivent l'utilisation de BlueXP en mode standard. Vous devez activer le mode restreint uniquement si vous disposez d'un environnement sécurisé et souhaitez déconnecter ce compte des services back-end BlueXP. Si c'est le cas, link:task-quick-start-restricted-mode.html["Suivez les étapes pour démarrer avec BlueXP en mode restreint"].

.. Cliquez sur *commençons*.




.Résultat
Le connecteur est maintenant installé et configuré avec votre compte BlueXP.

.Et la suite ?
link:task-provide-permissions-google.html["Fournissez à BlueXP les autorisations que vous avez précédemment configurées"].

--
====